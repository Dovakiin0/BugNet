import{j as r,T as a,F as n,N as x,u as p,r as g}from"./index-edf1aac6.js";import{B as h}from"./Bugs-2ca9d492.js";import{a as m}from"./axios-bf91d915.js";import{a as j,A as f,l as B}from"./index-4c505b39.js";import{a as y,S as l}from"./Skeleton-3d1a8256.js";import{E as u,h as w}from"./Empty-48f7f6fa.js";import{u as E}from"./useToast-a4b8a2c8.js";import{B as d}from"./chunk-6CSUKJP7-d42b8060.js";import{u as v}from"./useComments-6830dadf.js";const S=async()=>{const{data:e}=await m.get("/api/v1/bugs",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});return e};function k(){return j(["bugs"],()=>S())}function A({}){const{isLoading:e,data:i,isError:s,error:c}=k(),{errorToast:o}=E();return s&&o("Error getting results"),r.jsx(r.Fragment,{children:r.jsxs(d,{margin:"10px",padding:"20px",rounded:10,width:"full",children:[r.jsx(a,{fontWeight:"bold",color:"primary.200",children:"Recent Bugs"}),r.jsx(y,{direction:"column",spacing:"4",padding:"10px",children:e?r.jsx(r.Fragment,{children:r.jsx(l,{height:"60px"})}):i.length>0?i.map(t=>t.status==="Open"&&r.jsx(h,{projectTitle:t.Project.title,author:t.User.username,...t},t.id)):r.jsx(u,{message:"Newly created bugs from across your projects will appear here"})})]})})}function N({comment:e}){return r.jsxs(n,{marginTop:"20px",gap:"5",align:"center",children:[r.jsx(f,{name:e.User.username,src:e.User.avatar,width:10,height:10}),r.jsxs(n,{flexDir:"column",children:[r.jsx(x,{to:`/bugs/${e.Bug.id}`,children:r.jsxs(a,{color:"primary.200",fontSize:"sm",_hover:{color:"purple.300"},children:[e.User.username," commented on #",e.Bug.id,"/",e.Bug.title," -- ",e.Bug.Project.title]})}),r.jsx(a,{color:"primary.300",fontSize:"xs",children:w(e.createdAt).fromNow()})]})]})}function T({}){const{data:e,isLoading:i}=v();let s,c=p();return g.useEffect(()=>{s=B("ws://bugnet.onrender.com"),s.on("COMMENT_RESPONSE",o=>{c.invalidateQueries(["comment"])})},[s]),r.jsxs(d,{margin:"10px",padding:"20px",rounded:10,maxWidth:"400px",width:"400px",children:[r.jsx(a,{fontWeight:"bold",color:"primary.200",children:"Activities"}),i?r.jsx(r.Fragment,{children:r.jsx(l,{height:"60px"})}):e.length>0?e.map(o=>r.jsx(N,{comment:o})):r.jsx(u,{message:"Nothing new to show"})]})}function Q({}){return r.jsx(r.Fragment,{children:r.jsxs(n,{flexGrow:"1",children:[r.jsx(A,{}),r.jsx(T,{})]})})}export{Q as default};
